{
    "lake_county": "SELECT json_build_object('type', 'Feature', 'geometry', ST_AsGeoJSON(ST_Transform(way, 4326))::json, 'properties', json_build_object('stroke-width', 2, 'stroke-opacity', 1, 'fill-opacity', 0)) FROM planet_osm_polygon WHERE name='Lake County'",
    
    "all_hospitals": "WITH hospitals AS (select name, ST_Centroid(way) as way from planet_osm_polygon where amenity='hospital' or amenity='clinic' or amenity='doctors' union select name, way from planet_osm_point where amenity='hospital' or amenity='clinic' or amenity='doctors') select json_build_object('type', 'Feature', 'geometry', ST_AsGeoJSON(ST_Transform(h.way, 4326))::JSON, 'properties', json_build_object('title', h.name, 'marker-size', 'medium', 'marker-color', '#af0816')) from hospitals h cross join (select p.way from planet_osm_polygon p where name='Lake County') as county where ST_Contains(county.way, h.way)",
    
    "get_mortality_rate": "SELECT json_build_object('type', 'Feature', 'geometry', ST_AsGeoJSON(ST_Transform(wkb_geometry, 4326))::json, 'properties', json_build_object('description', round(avg_age::numeric, 2), 'stroke-width', 1, 'stroke-opacity', 1, 'fill', '#00BFFF', 'fill-opacity', 0.5)) FROM mortality_rates",
    
    "get_stats": "WITH hospitals AS (select name, st_transform(ST_Centroid(way), 4326) as way from planet_osm_polygon where amenity='hospital' or amenity='clinic' or amenity='doctors' union select name, st_transform(way, 4326) from planet_osm_point where amenity='hospital' or amenity='clinic' or amenity='doctors') select json_build_object('type', 'Feature', 'geometry', ST_AsGeoJSON(ST_Centroid(wkb_geometry))::JSON, 'properties', json_build_object('title', 'Priemerny vek umrtia: ' || round(avg_age::numeric, 2), 'marker-size', 'medium', 'marker-color', '#4B0082', 'marker-symbol', count(h.way)::text)) from mortality_rates left join hospitals h on ST_Contains(wkb_geometry, h.way) group by wkb_geometry, avg_age",
    
    "get_closest": "WITH hospitals AS (select name, st_transform(ST_Centroid(way), 4326) as way from planet_osm_polygon where amenity='hospital' or amenity='clinic' or amenity='doctors' union select name, st_transform(way, 4326) from planet_osm_point where amenity='hospital' or amenity='clinic' or amenity='doctors'), county AS (select st_transform(way, 4326) as way from planet_osm_polygon where name='Lake County'), closest AS (select h.name, h.way, ST_Distance(ST_SetSRID(ST_Point(cast(%s as float), cast(%s as float)), 4326)::geography, h.way::geography) as dist from hospitals h cross join county where ST_Contains(county.way, h.way) order by dist asc limit 1) select json_build_object('type', 'Feature', 'geometry', ST_AsGeoJSON(ST_Transform(way, 4326))::JSON, 'properties', json_build_object('title', name, 'description', 'Vzdialenost: ' || round(dist::numeric, 2) || ' metrov','marker-size', 'medium', 'marker-color', '#af0816')) from closest",

    "get_pin_from_coords": "select json_build_object('type', 'Feature', 'geometry', ST_AsGeoJSON(ST_SetSRID(ST_Point(cast(%s as float), cast(%s as float)), 4326))::JSON, 'properties', json_build_object('marker-size', 'medium', 'marker-color', '#191970'))"
}
